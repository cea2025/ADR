var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,d=(e,t)=>{for(var s in t||(t={}))r.call(t,s)&&l(e,s,t[s]);if(a)for(var s of a(t))n.call(t,s)&&l(e,s,t[s]);return e},c=(e,a)=>t(e,s(a));import{c as i,u as x,a as m,j as o,h,C as p,S as u,T as b}from"./index-C9r9jJrI.js";import{r as g}from"./vendor-Bz3rmKJE.js";import{u as j}from"./mobile-CwmOuqsT.js";import{D as f,C as N,B as w,a as v}from"./download-KXPk3Ni7.js";import"./pdf-CFP917pd.js";
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=i("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),C=i("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),R=()=>{const{selectedPolicies:e,addPolicy:t,removePolicy:s,updatePolicyUnits:a}=x(),{policies:r}=m(),[n,l]=g.useState(0),i=j({onSwipedLeft:()=>{l(e=>Math.min(e+1,r.length-1))},onSwipedRight:()=>{l(e=>Math.max(e-1,0))},trackMouse:!0}),h=(a,r=1)=>{e.find(e=>e.policyId===a)?s(a):t({policyId:a,units:r})},p=(e,t)=>{t>0&&t<=10&&a(e,t)},u=t=>e.find(e=>e.policyId===t),b=e=>"number"==typeof e?`${e} שנים`:`${e.male}/${e.female} שנים`,v=e=>{switch(e){case"AAA":return"text-green-400";case"AA+":return"text-blue-400";case"AA":return"text-blue-500";case"A+":return"text-yellow-400";case"A":return"text-yellow-500";default:return"text-gray-400"}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h3",{className:"text-2xl font-bold text-adr-brown mb-2",children:"בחר פוליסות להשקעה"}),o.jsx("p",{className:"text-adr-light-brown",children:"בחר עד 10 פוליסות שונות, עד 10 יחידות לכל פוליסה"})]}),o.jsx("div",{className:"hidden sm:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-6",children:r.filter(e=>!1!==e.isActive).map(e=>{const t=u(e.id),s=(null==t?void 0:t.units)||0;return o.jsxs("div",{className:"card-policy transition-all duration-300 cursor-pointer hover:scale-105 "+(t?"ring-4 ring-adr-gold":""),onClick:()=>h(e.id),children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 md:space-x-3 space-x-reverse",children:[o.jsxs("div",{className:"relative",children:[o.jsx(y,{className:"w-6 h-6 md:w-8 md:h-8 text-adr-gold"}),o.jsx(f,{className:"w-3 h-3 md:w-4 md:h-4 text-adr-brown absolute -top-1 -right-1"})]}),o.jsx("h4",{className:"text-base md:text-lg font-bold truncate",children:e.name})]}),o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(C,{className:`w-4 h-4 md:w-5 md:h-5 ${v(e.companyRating)}`}),o.jsx("span",{className:"text-xs md:text-sm font-medium",children:e.companyRating})]})]}),o.jsxs("div",{className:"space-y-2 md:space-y-3 text-adr-gold text-sm md:text-base",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"flex items-center space-x-1 md:space-x-2 space-x-reverse",children:[o.jsx(f,{className:"w-3 h-3 md:w-4 md:h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"פדיון:"}),o.jsx("span",{className:"sm:hidden",children:"פדיון"})]}),o.jsxs("span",{className:"text-white font-semibold text-xs md:text-sm",children:["$",e.faceValue.toLocaleString()]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"flex items-center space-x-1 md:space-x-2 space-x-reverse",children:[o.jsx(N,{className:"w-3 h-3 md:w-4 md:h-4"}),o.jsx("span",{children:"גיל:"})]}),o.jsx("span",{className:"text-white font-semibold text-xs md:text-sm",children:b(e.age)})]}),o.jsxs("div",{className:"hidden sm:flex items-center justify-between",children:[o.jsxs("span",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(w,{className:"w-4 h-4"}),o.jsx("span",{children:"חברה:"})]}),o.jsx("span",{className:"text-white font-semibold text-sm",children:e.insuranceCompany})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"LE:"}),o.jsxs("span",{className:"text-white font-semibold text-xs md:text-sm",children:[e.lifeExpectancy," שנים"]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"hidden sm:inline",children:"עלות רכישה:"}),o.jsx("span",{className:"sm:hidden",children:"עלות:"}),o.jsxs("span",{className:"text-white font-semibold text-xs md:text-sm",children:["$",e.purchaseCost.toLocaleString()]})]})]}),t&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-adr-gold",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-adr-gold text-sm font-medium",children:"יחידות:"}),o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:t=>{t.stopPropagation(),p(e.id,Math.max(1,s-1))},className:"w-10 h-10 md:w-8 md:h-8 bg-adr-light-brown rounded-full flex items-center justify-center text-white hover:bg-adr-bronze transition-colors active:scale-95",children:o.jsx("span",{className:"text-lg md:text-base font-bold",children:"-"})}),o.jsx("span",{className:"text-white font-bold min-w-[2.5rem] md:min-w-[2rem] text-center text-lg md:text-base",children:s}),o.jsx("button",{onClick:t=>{t.stopPropagation(),p(e.id,Math.min(10,s+1))},className:"w-10 h-10 md:w-8 md:h-8 bg-adr-light-brown rounded-full flex items-center justify-center text-white hover:bg-adr-bronze transition-colors active:scale-95",children:o.jsx("span",{className:"text-lg md:text-base font-bold",children:"+"})})]})]}),o.jsxs("p",{className:"text-xs text-adr-gold mt-2 text-center",children:['סה"כ: $',(e.purchaseCost*s).toLocaleString()]})]}),t&&o.jsx("div",{className:"absolute top-4 right-4",children:o.jsx("div",{className:"w-6 h-6 bg-adr-gold rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-adr-brown text-sm font-bold",children:"✓"})})})]},e.id)})}),o.jsx("div",c(d({className:"sm:hidden"},i),{children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"text-center mb-4",children:o.jsxs("span",{className:"text-sm text-adr-light-brown",children:[n+1," מתוך ",r.filter(e=>!1!==e.isActive).length]})}),o.jsx("div",{className:"relative",children:r.filter(e=>!1!==e.isActive).map((e,t)=>{const s=u(e.id),a=(null==s?void 0:s.units)||0,r=t===n;return o.jsxs("div",{className:`card-policy transition-all duration-300 cursor-pointer ${r?"block":"hidden"} ${s?"ring-4 ring-adr-gold":""}`,onClick:()=>h(e.id),children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 md:space-x-3 space-x-reverse",children:[o.jsxs("div",{className:"relative",children:[o.jsx(y,{className:"w-6 h-6 md:w-8 md:h-8 text-adr-gold"}),o.jsx(f,{className:"w-3 h-3 md:w-4 md:h-4 text-adr-brown absolute -top-1 -right-1"})]}),o.jsx("h4",{className:"text-base md:text-lg font-bold truncate",children:e.name})]}),o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(C,{className:`w-4 h-4 md:w-5 md:h-5 ${v(e.companyRating)}`}),o.jsx("span",{className:"text-xs md:text-sm font-medium",children:e.companyRating})]})]}),o.jsxs("div",{className:"space-y-2 md:space-y-3 text-adr-gold text-sm md:text-base",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"flex items-center space-x-1 md:space-x-2 space-x-reverse",children:[o.jsx(f,{className:"w-3 h-3 md:w-4 md:h-4"}),o.jsx("span",{children:"פדיון:"})]}),o.jsxs("span",{className:"text-white font-semibold text-xs md:text-sm",children:["$",e.faceValue.toLocaleString()]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"flex items-center space-x-1 md:space-x-2 space-x-reverse",children:[o.jsx(N,{className:"w-3 h-3 md:w-4 md:h-4"}),o.jsx("span",{children:"גיל:"})]}),o.jsx("span",{className:"text-white font-semibold text-xs md:text-sm",children:b(e.age)})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"LE:"}),o.jsxs("span",{className:"text-white font-semibold text-xs md:text-sm",children:[e.lifeExpectancy," שנים"]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"עלות:"}),o.jsxs("span",{className:"text-white font-semibold text-xs md:text-sm",children:["$",e.purchaseCost.toLocaleString()]})]})]}),s&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-adr-gold",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-adr-gold text-sm font-medium",children:"יחידות:"}),o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:t=>{t.stopPropagation(),p(e.id,Math.max(1,a-1))},className:"w-10 h-10 md:w-8 md:h-8 bg-adr-light-brown rounded-full flex items-center justify-center text-white hover:bg-adr-bronze transition-colors active:scale-95",children:o.jsx("span",{className:"text-lg md:text-base font-bold",children:"-"})}),o.jsx("span",{className:"text-white font-bold min-w-[2.5rem] md:min-w-[2rem] text-center text-lg md:text-base",children:a}),o.jsx("button",{onClick:t=>{t.stopPropagation(),p(e.id,Math.min(10,a+1))},className:"w-10 h-10 md:w-8 md:h-8 bg-adr-light-brown rounded-full flex items-center justify-center text-white hover:bg-adr-bronze transition-colors active:scale-95",children:o.jsx("span",{className:"text-lg md:text-base font-bold",children:"+"})})]})]}),o.jsxs("p",{className:"text-xs text-adr-gold mt-2 text-center",children:['סה"כ: $',(e.purchaseCost*a).toLocaleString()]})]}),s&&o.jsx("div",{className:"absolute top-4 right-4",children:o.jsx("div",{className:"w-6 h-6 bg-adr-gold rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-adr-brown text-sm font-bold",children:"✓"})})})]},e.id)})}),o.jsx("div",{className:"text-center mt-4",children:o.jsx("p",{className:"text-xs text-adr-light-brown",children:"החלק ימינה/שמאלה לעבור בין פוליסות"})})]})})),e.length>0&&o.jsxs("div",{className:"bg-adr-light-brown rounded-lg p-6 text-center",children:[o.jsx("h4",{className:"text-xl font-bold text-white mb-2",children:"סיכום בחירה"}),o.jsxs("p",{className:"text-adr-brown",children:["נבחרו ",e.length," פוליסות"]})]})]})},P=({onCalculate:e,isCalculating:t})=>{const{selectedPolicies:s,userType:a,exchangeRate:r,setExchangeRate:n,getTotalInvestment:l}=x(),[i,m]=g.useState("highest"),[b,j]=g.useState({managementFees:!0,openingCosts:!0}),N=h(a,"actualLE"),w=l();return o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-8 border border-adr-brown",children:[o.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[o.jsx("h3",{className:"text-xl md:text-2xl font-bold text-adr-brown mb-2",children:"הגדרות חישוב"}),o.jsx("p",{className:"text-base md:text-lg text-adr-light-brown",children:"הגדר את הפרמטרים לחישוב התשואה"})]}),o.jsxs("form",{onSubmit:t=>{if(t.preventDefault(),0===s.length)return void alert("אנא בחר לפחות פוליסה אחת");e({selectedPolicies:s,leCalculationMethod:i,includeCostsInReturn:b,exchangeRate:r})},className:"space-y-6",children:[o.jsxs("div",{className:"bg-adr-cream rounded-lg p-4 md:p-6",children:[o.jsxs("h4",{className:"text-base md:text-lg font-semibold text-adr-brown mb-3 md:mb-4 flex items-center",children:[o.jsx(f,{className:"w-4 h-4 md:w-5 md:h-5 mr-2"}),"סיכום השקעה"]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 md:gap-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-adr-light-brown text-xs md:text-sm",children:"פוליסות נבחרות"}),o.jsx("p",{className:"text-xl md:text-2xl font-bold text-adr-brown",children:s.length})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-adr-light-brown text-xs md:text-sm",children:'סה"כ השקעה'}),o.jsxs("p",{className:"text-xl md:text-2xl font-bold text-adr-brown",children:["$",w.toLocaleString()]})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-adr-light-brown text-xs md:text-sm",children:"בשקלים"}),o.jsxs("p",{className:"text-xl md:text-2xl font-bold text-adr-brown",children:["₪",(w*r).toLocaleString()]})]})]})]}),o.jsxs("div",{className:"space-y-3 md:space-y-4",children:[o.jsxs("h4",{className:"text-base md:text-lg font-semibold text-adr-brown flex items-center",children:[o.jsx(p,{className:"w-4 h-4 md:w-5 md:h-5 mr-2"}),"שיטת חישוב Life Expectancy"]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 md:gap-4",children:[o.jsxs("label",{className:"flex items-center space-x-3 space-x-reverse cursor-pointer",children:[o.jsx("input",{type:"radio",name:"leMethod",value:"highest",checked:"highest"===i,onChange:e=>m(e.target.value),className:"text-adr-brown focus:ring-adr-gold"}),o.jsx("span",{className:"text-adr-brown",children:"LE הגבוה"})]}),o.jsxs("label",{className:"flex items-center space-x-3 space-x-reverse cursor-pointer",children:[o.jsx("input",{type:"radio",name:"leMethod",value:"average",checked:"average"===i,onChange:e=>m(e.target.value),className:"text-adr-brown focus:ring-adr-gold"}),o.jsx("span",{className:"text-adr-brown",children:"LE ממוצע"})]}),o.jsxs("label",{className:"flex items-center space-x-3 space-x-reverse cursor-pointer",children:[o.jsx("input",{type:"radio",name:"leMethod",value:"actual",checked:"actual"===i,onChange:e=>m(e.target.value),disabled:!N,className:"text-adr-brown focus:ring-adr-gold "+(N?"":"opacity-50 cursor-not-allowed")}),o.jsxs("span",{className:""+(N?"text-adr-brown":"text-adr-light-brown"),children:["LE אמיתי ",!N&&"(מנהלים בלבד)"]})]})]})]}),o.jsxs("div",{className:"space-y-3 md:space-y-4",children:[o.jsxs("h4",{className:"text-base md:text-lg font-semibold text-adr-brown flex items-center",children:[o.jsx(u,{className:"w-4 h-4 md:w-5 md:h-5 mr-2"}),"כלילת עלויות בחישוב"]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4",children:[o.jsxs("label",{className:"flex items-center space-x-3 space-x-reverse cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:b.managementFees,onChange:e=>j(t=>c(d({},t),{managementFees:e.target.checked})),className:"text-adr-brown focus:ring-adr-gold rounded"}),o.jsx("span",{className:"text-adr-brown",children:"דמי ניהול חודשיים"})]}),o.jsxs("label",{className:"flex items-center space-x-3 space-x-reverse cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:b.openingCosts,onChange:e=>j(t=>c(d({},t),{openingCosts:e.target.checked})),className:"text-adr-brown focus:ring-adr-gold rounded"}),o.jsx("span",{className:"text-adr-brown",children:"עלויות פתיחת תיק"})]})]})]}),o.jsxs("div",{className:"space-y-3 md:space-y-4",children:[o.jsx("h4",{className:"text-base md:text-lg font-semibold text-adr-brown",children:"שער חליפין דולר-שקל"}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-4 space-x-reverse",children:[o.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[o.jsx("input",{type:"number",value:r,onChange:e=>n(parseFloat(e.target.value)||0),step:"0.01",min:"0",className:"input-field w-32 text-center",placeholder:"3.65"}),o.jsx("span",{className:"text-adr-brown text-sm md:text-base",children:"₪ לדולר"})]}),o.jsx("button",{type:"button",onClick:()=>n(3.65),className:"text-adr-light-brown hover:text-adr-brown text-xs md:text-sm underline",children:"איפוס לשער נוכחי"})]})]}),o.jsx("div",{className:"text-center pt-4 md:pt-6",children:o.jsx("button",{type:"submit",disabled:t||0===s.length,className:"btn-primary w-full sm:w-auto "+(t||0===s.length?"opacity-50 cursor-not-allowed":""),children:t?"מחשב...":"חשב תשואה"})})]})]})},M=({results:e})=>{const t=(e,t="USD")=>`${"USD"===t?"$":"₪"}${e.toLocaleString()}`,s=e=>`${e.toFixed(1)}%`;return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h3",{className:"text-3xl font-bold text-adr-brown mb-2",children:"תוצאות החישוב"}),o.jsx("p",{className:"text-lg text-adr-light-brown",children:"סיכום התשואה הצפויה מההשקעה"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-6",children:[o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"flex items-center justify-center mb-2 md:mb-4",children:o.jsx(f,{className:"w-6 h-6 md:w-8 md:h-8 text-adr-gold"})}),o.jsx("h4",{className:"text-adr-gold text-xs md:text-sm font-medium mb-2",children:'סה"כ השקעה'}),o.jsx("p",{className:"text-white text-2xl md:text-3xl font-bold",children:t(e.totalPurchaseCost)}),o.jsx("p",{className:"text-adr-gold text-xs md:text-sm mt-1",children:t(e.currencyConversion.totalInILS,"ILS")})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"flex items-center justify-center mb-2 md:mb-4",children:o.jsx(b,{className:"w-6 h-6 md:w-8 md:h-8 text-adr-gold"})}),o.jsx("h4",{className:"text-adr-gold text-xs md:text-sm font-medium mb-2",children:"תשואה צפויה"}),o.jsx("p",{className:"text-white text-2xl md:text-3xl font-bold",children:t(e.expectedReturns.average.totalReturn)}),o.jsx("p",{className:"text-adr-gold text-xs md:text-sm mt-1",children:s(e.expectedReturns.average.totalReturnPercentage)})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"flex items-center justify-center mb-2 md:mb-4",children:o.jsx(N,{className:"w-6 h-6 md:w-8 md:h-8 text-adr-gold"})}),o.jsx("h4",{className:"text-adr-gold text-xs md:text-sm font-medium mb-2",children:"רווח נטו"}),o.jsx("p",{className:"text-white text-2xl md:text-3xl font-bold",children:t(e.expectedReturns.average.netProfit)}),o.jsxs("p",{className:"text-adr-gold text-xs md:text-sm mt-1",children:[s(e.expectedReturns.average.annualizedReturn)," לשנה"]})]}),o.jsxs("div",{className:"metric-card",children:[o.jsx("div",{className:"flex items-center justify-center mb-2 md:mb-4",children:o.jsx(b,{className:"w-6 h-6 md:w-8 md:h-8 text-adr-gold"})}),o.jsx("h4",{className:"text-adr-gold text-xs md:text-sm font-medium mb-2",children:"תקופה עד פקיעה"}),o.jsx("p",{className:"text-white text-2xl md:text-3xl font-bold",children:e.expectedReturns.average.timeToMaturity}),o.jsx("p",{className:"text-adr-gold text-xs md:text-sm mt-1",children:"שנים"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-6 border border-adr-brown",children:[o.jsx("h4",{className:"text-lg md:text-xl font-bold text-adr-brown mb-3 md:mb-4",children:"פירוט השקעה"}),o.jsxs("div",{className:"space-y-3 md:space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-adr-cream",children:[o.jsx("span",{className:"text-adr-light-brown text-sm md:text-base",children:"עלות רכישה"}),o.jsx("span",{className:"font-semibold text-adr-brown text-sm md:text-base",children:t(e.totalPurchaseCost)})]}),o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-adr-cream",children:[o.jsx("span",{className:"text-adr-light-brown text-sm md:text-base",children:"דמי ניהול"}),o.jsx("span",{className:"font-semibold text-adr-brown text-sm md:text-base",children:t(e.totalManagementFees)})]}),o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-adr-cream",children:[o.jsx("span",{className:"text-adr-light-brown text-sm md:text-base",children:"עלויות פתיחה"}),o.jsx("span",{className:"font-semibold text-adr-brown text-sm md:text-base",children:t(e.totalOpeningCosts)})]}),o.jsxs("div",{className:"flex justify-between items-center py-3 bg-adr-cream rounded-lg px-3 md:px-4",children:[o.jsx("span",{className:"font-bold text-adr-brown text-sm md:text-base",children:'סה"כ עלויות'}),o.jsx("span",{className:"font-bold text-adr-brown text-sm md:text-base",children:t(e.totalPurchaseCost+e.totalManagementFees+e.totalOpeningCosts)})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-6 border border-adr-brown",children:[o.jsx("h4",{className:"text-lg md:text-xl font-bold text-adr-brown mb-3 md:mb-4",children:"ניתוח תשואה"}),o.jsxs("div",{className:"space-y-3 md:space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-adr-cream",children:[o.jsx("span",{className:"text-adr-light-brown text-sm md:text-base",children:"תשואה שנתית"}),o.jsx("span",{className:"font-semibold text-adr-brown text-sm md:text-base",children:s(e.expectedReturns.average.annualizedReturn)})]}),o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-adr-cream",children:[o.jsx("span",{className:"text-adr-light-brown text-sm md:text-base",children:"ריבית דריבית"}),o.jsx("span",{className:"font-semibold text-adr-brown text-sm md:text-base",children:s(e.expectedReturns.average.compoundReturn)})]}),o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-adr-cream",children:[o.jsx("span",{className:"text-adr-light-brown text-sm md:text-base",children:"תשואה כוללת"}),o.jsx("span",{className:"font-semibold text-adr-brown text-sm md:text-base",children:s(e.expectedReturns.average.totalReturnPercentage)})]}),o.jsxs("div",{className:"flex justify-between items-center py-3 bg-adr-cream rounded-lg px-3 md:px-4",children:[o.jsx("span",{className:"font-bold text-adr-brown text-sm md:text-base",children:"רווח נטו"}),o.jsx("span",{className:"font-bold text-adr-brown text-sm md:text-base",children:t(e.expectedReturns.average.netProfit)})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-6 border border-adr-brown",children:[o.jsx("h4",{className:"text-lg md:text-xl font-bold text-adr-brown mb-3 md:mb-4",children:"המרת מטבע"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 md:gap-6 text-center",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-adr-light-brown text-xs md:text-sm mb-2",children:"שער חליפין"}),o.jsxs("p",{className:"text-xl md:text-2xl font-bold text-adr-brown",children:["1$ = ₪",e.currencyConversion.usdToIls]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-adr-light-brown text-xs md:text-sm mb-2",children:"השקעה בדולרים"}),o.jsx("p",{className:"text-xl md:text-2xl font-bold text-adr-brown",children:t(e.totalPurchaseCost)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-adr-light-brown text-xs md:text-sm mb-2",children:"השקעה בשקלים"}),o.jsx("p",{className:"text-xl md:text-2xl font-bold text-adr-brown",children:t(e.currencyConversion.totalInILS,"ILS")})]})]})]}),o.jsx("div",{className:"text-center",children:o.jsxs("button",{onClick:()=>{},className:"btn-primary flex items-center mx-auto space-x-2 space-x-reverse",children:[o.jsx(v,{className:"w-5 h-5"}),o.jsx("span",{children:"ייצא ל-PDF"})]})})]})};
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */class S{static calculatePolicyReturn(e,t,s,a,r){const n=e.purchaseCost*t,l=e.faceValue*t;let d=e.lifeExpectancy;switch(s){case"highest":d=1.2*e.lifeExpectancy;break;case"average":d=e.lifeExpectancy;break;case"actual":d=.9*e.lifeExpectancy}const c=12*d,i=e.monthlyPremium*t*c;let x=0,m=0;a.managementFees&&(x=e.monthlyManagementFee*t*c,e.managementDiscount&&(x-=e.managementDiscount*t)),a.openingCosts&&(m=e.openingCost*t/r,e.openingDiscount&&(m-=e.openingDiscount*t/r));const o=n+i+x+m,h=l-o,p=100*(Math.pow(l/o,1/d)-1);return{totalReturn:l,netProfit:h,annualizedReturn:p,compoundReturn:100*(Math.pow(1+p/100,d)-1),totalReturnPercentage:(l-o)/o*100,timeToMaturity:d}}static calculatePortfolioReturns(e,t,s){const{leCalculationMethod:a,includeCostsInReturn:r,exchangeRate:n=3.7}=s,l=t.map(t=>{const s=e.find(e=>e.id===t.policyId);if(!s)throw new Error(`Policy not found: ${t.policyId}`);return this.calculatePolicyReturn(s,t.units,a,r,n)}),d=t.reduce((t,s)=>{const a=e.find(e=>e.id===s.policyId);return t+((null==a?void 0:a.purchaseCost)||0)*s.units},0),c=r.managementFees?t.reduce((t,s)=>{const r=e.find(e=>e.id===s.policyId);if(!r)return t;const n=12*this.getAdjustedLE(r.lifeExpectancy,a);let l=r.monthlyManagementFee*s.units*n;return r.managementDiscount&&(l-=r.managementDiscount*s.units),t+l},0):0,i=r.openingCosts?t.reduce((t,s)=>{const a=e.find(e=>e.id===s.policyId);if(!a)return t;let r=a.openingCost*s.units/n;return a.openingDiscount&&(r-=a.openingDiscount*s.units/n),t+r},0):0,x=d+c+i,m=l.reduce((e,t)=>e+t.totalReturn,0),o=l.reduce((e,t)=>e+t.netProfit,0),h=t.reduce((t,s)=>{const r=e.find(e=>e.id===s.policyId);if(!r)return t;const n=r.purchaseCost*s.units/d;return t+this.getAdjustedLE(r.lifeExpectancy,a)*n},0),p={totalReturn:m,netProfit:o,annualizedReturn:100*(Math.pow(m/x,1/h)-1),compoundReturn:100*(Math.pow(1+o/x/h,h)-1),totalReturnPercentage:o/x*100,timeToMaturity:h},u=[];for(let b=1;b<=Math.ceil(h);b++){const e=x*(p.annualizedReturn/100),t=e*b,s=x*Math.pow(1+p.annualizedReturn/100,b)-x;u.push({year:b,cumulativeReturn:t,annualReturn:e,withCompounding:s,withoutCompounding:e})}return{totalPurchaseCost:d,totalManagementFees:c,totalOpeningCosts:i,expectedReturns:{individual:l,average:p,actual:p},annualBreakdown:u,currencyConversion:{usdToIls:n,totalInILS:m*n}}}static getAdjustedLE(e,t){switch(t){case"highest":return 1.2*e;case"average":default:return e;case"actual":return.9*e}}static validateCalculationInput(e,t){const s=[];return 0===t.length&&s.push("יש לבחור לפחות פוליסה אחת"),t.length>10&&s.push("ניתן לבחור עד 10 פוליסות בלבד"),t.forEach(t=>{const a=e.find(e=>e.id===t.policyId);a?((t.units<=0||t.units>10)&&s.push(`כמות יחידות לא תקינה עבור ${a.name}: ${t.units}`),a.purchaseCost<=0&&s.push(`עלות רכישה לא תקינה עבור ${a.name}`),a.faceValue<=a.purchaseCost&&s.push(`ערך נקוב קטן מעלות הרכישה עבור ${a.name}`),(a.lifeExpectancy<=0||a.lifeExpectancy>50)&&s.push(`תוחלת חיים לא תקינה עבור ${a.name}: ${a.lifeExpectancy}`)):s.push(`פוליסה לא נמצאה: ${t.policyId}`)}),{isValid:0===s.length,errors:s}}static calculateRiskMetrics(e,t){const s=t.map(t=>{const s=e.find(e=>e.id===t.policyId);return s?"number"==typeof s.age?s.age:(s.age.male+s.age.female)/2:0}),a=s.reduce((e,t)=>e+t,0)/s.length,r=s.reduce((e,t)=>e+Math.pow(t-a,2),0)/s.length,n=Math.sqrt(r),l=t.map(t=>{const s=e.find(e=>e.id===t.policyId);return(null==s?void 0:s.insuranceCompany)||""}),d=new Set(l).size/t.length;let c=5;a>85?c-=2:a<70&&(c+=2),n>5&&(c+=1),d<.5&&(c+=1);const i=t.reduce((t,s)=>{const a=e.find(e=>e.id===s.policyId);if(!a)return t;return t+({A:1,"A+":2,AA:3,"AA+":4,AAA:5}[a.companyRating]||1)},0)/t.length;return i<2.5&&(c+=1),c=Math.max(1,Math.min(10,c)),{riskScore:c,averageAge:a,ageStandardDeviation:n,diversificationRatio:d,averageRating:i,recommendedAction:c<=4?"השקעה מומלצת":c<=7?"השקעה זהירה":"השקעה מסוכנת"}}}const I=()=>{const[e,t]=g.useState(null),[s,a]=g.useState(!1),{policies:r}=m();return o.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 md:space-y-8 px-4 md:px-0",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-2xl md:text-4xl font-bold text-adr-brown mb-3 md:mb-4",children:"מחשבון Life Settlements"}),o.jsx("p",{className:"text-base md:text-lg text-adr-light-brown",children:"חשב את התשואה הצפויה מהשקעה בפוליסות ביטוח חיים"})]}),o.jsx(R,{}),o.jsx(P,{onCalculate:e=>{return s=void 0,n=null,l=function*(){a(!0);try{yield new Promise(e=>setTimeout(e,800));const s=((e,t)=>{const s=S.validateCalculationInput(e,t.selectedPolicies);if(!s.isValid)throw new Error(`שגיאות בנתונים: ${s.errors.join(", ")}`);return S.calculatePortfolioReturns(e,t.selectedPolicies,t)})(r,e);t(s)}catch(s){alert(`שגיאה בחישוב: ${s instanceof Error?s.message:"שגיאה לא ידועה"}`)}finally{a(!1)}},new Promise((e,t)=>{var a=e=>{try{d(l.next(e))}catch(s){t(s)}},r=e=>{try{d(l.throw(e))}catch(s){t(s)}},d=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);d((l=l.apply(s,n)).next())});var s,n,l},isCalculating:s}),e&&o.jsx(M,{results:e}),s&&o.jsxs("div",{className:"text-center py-8 md:py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-10 w-10 md:h-12 md:w-12 border-b-2 border-adr-brown"}),o.jsx("p",{className:"mt-3 md:mt-4 text-adr-brown text-base md:text-lg",children:"מחשב..."})]})]})};export{I as default};
